(()=>{var t={561:function(){(function(){var t=[].slice;String.prototype.autoLink=function(){var o,e,r,i,n,a;return n=/(^|[\s\n]|<[A-Za-z]*\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,0<(i=1<=arguments.length?t.call(arguments,0):[]).length?(r=i[0],e=function(){var t;for(o in t=[],r)a=r[o],"callback"!==o&&t.push(" "+o+"='"+a+"'");return t}().join(""),this.replace(n,(function(t,o,i){return""+o+(("function"==typeof r.callback?r.callback(i):void 0)||"<a href='"+i+"'"+e+">"+i+"</a>")}))):this.replace(n,"$1<a href='$2'>$2</a>")}}).call(this)}},o={};function e(r){var i=o[r];if(void 0!==i)return i.exports;var n=o[r]={exports:{}};return t[r].call(n.exports,n,n.exports,e),n.exports}e.n=t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},e.d=(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},e.o=(t,o)=>Object.prototype.hasOwnProperty.call(t,o),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";e.r(r),e.d(r,{components:()=>P});const t=flarum.core.compat["forum/app"];var o=e.n(t);const i=flarum.core.compat["common/extend"];e(561),flarum.core.compat["common/utils/computed"];const n=flarum.core.compat["forum/components/UserCard"];var a=e.n(n);const s=flarum.core.compat["common/models/User"];var c=e.n(s);const u=flarum.core.compat["common/Model"];var l=e.n(u);function p(t,o){return p=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},p(t,o)}const f=flarum.core.compat["common/Component"];var d=e.n(f);const h=flarum.core.compat["common/components/LoadingIndicator"];var b=e.n(h);const v=flarum.core.compat["common/utils/classList"];var g=e.n(v);const y=flarum.core.compat["common/utils/extractText"];var x=e.n(y),w=function(t){var e,r;function i(){return t.apply(this,arguments)||this}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,p(e,r);var n=i.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.editing=!1,this.loading=!1,this.bioMaxLength=o().forum.attribute("fof-user-bio.maxLength"),this.bioPlaceholder=o().session&&o().session.user&&o().session.user.id()===this.attrs.user.id()?o().translator.trans("fof-user-bio.forum.userbioPlaceholder"):o().translator.trans("fof-user-bio.forum.userbioPlaceholderOtherUser",{username:this.attrs.user.username()})},n.view=function(){var t,o=this.attrs.user,e=this.attrs.user.attribute("canEditBio");if(this.editing)t=m("textarea",{className:"FormControl",placeholder:x()(this.bioPlaceholder),rows:"3",maxlength:this.bioMaxLength,value:o.bio()});else{var r;if(this.loading)r=m("p",{className:"UserBio-placeholder"},m(b(),null));else{var i=o.bioHtml();i?r=m.trust(i):o.bio()?r=m.trust("<p>"+$("<div/>").text(o.bio()).html().replace(/\n/g,"<br>").autoLink({rel:"nofollow ugc"})+"</p>"):e&&(r=m("p",{className:"UserBio-placeholder"},this.bioPlaceholder))}t=m("div",{className:"UserBio-content",onclick:e?this.edit.bind(this):function(){}},r)}return m("div",{className:"UserBio "+g()({editable:e,editing:this.editing})},t)},n.edit=function(){this.editing=!0,m.redraw.sync();var t=this,o=function(o){o.shiftKey||(o.preventDefault(),t.save($(this).val()))};this.$("textarea").focus().bind("blur",o).bind("keydown","return",o),m.redraw()},n.save=function(t){var o=this,e=this.attrs.user;e.bio()!==t&&(this.loading=!0,e.save({bio:t}).catch((function(){})).then((function(){o.loading=!1,m.redraw()}))),this.editing=!1,m.redraw()},i}(d()),P={UserBio:w};o().initializers.add("fof-user-bio",(function(){c().prototype.bio=l().attribute("bio"),c().prototype.bioHtml=l().attribute("bioHtml"),(0,i.extend)(a().prototype,"infoItems",(function(t){var o=this.attrs.user;o.attribute("canViewBio")&&t.add("bio",m(w,{user:o}),-100)}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map