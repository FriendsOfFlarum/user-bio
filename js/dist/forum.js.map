{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/user-bio/./node_modules/autolink-js/autolink-min.js","webpack://@fof/user-bio/webpack/bootstrap","webpack://@fof/user-bio/webpack/runtime/compat get default export","webpack://@fof/user-bio/webpack/runtime/define property getters","webpack://@fof/user-bio/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/user-bio/webpack/runtime/make namespace object","webpack://@fof/user-bio/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/utils/computed']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/models/User']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/user-bio/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/user-bio/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/user-bio/./src/forum/components/UserBio.js","webpack://@fof/user-bio/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/user-bio/./src/forum/components/index.js","webpack://@fof/user-bio/./src/forum/index.js"],"sourcesContent":["(function(){var h=[].slice;String.prototype.autoLink=function(){var b,f,d,a,e,g;a=1<=arguments.length?h.call(arguments,0):[];e=/(^|[\\s\\n]|<[A-Za-z]*\\/?>)((?:https?|ftp):\\/\\/[\\-A-Z0-9+\\u0026\\u2019@#\\/%?=()~_|!:,.;]*[\\-A-Z0-9+\\u0026@#\\/%=~()_|])/gi;if(!(0<a.length))return this.replace(e,\"$1<a href='$2'>$2</a>\");d=a[0];f=function(){var c;c=[];for(b in d)g=d[b],\"callback\"!==b&&c.push(\" \"+b+\"='\"+g+\"'\");return c}().join(\"\");return this.replace(e,function(c,b,a){c=(\"function\"===typeof d.callback?d.callback(a):\nvoid 0)||\"<a href='\"+a+\"'\"+f+\">\"+a+\"</a>\";return\"\"+b+c})}}).call(this);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/computed'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserCard'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\n\n/**\n * The `UserBio` component displays a user's bio, optionally letting the user\n * edit it.\n */\nexport default class UserBio extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    /**\n     * Whether or not the bio is currently being edited.\n     *\n     * @type {Boolean}\n     */\n    this.editing = false;\n\n    /**\n     * Whether or not the bio is currently being saved.\n     *\n     * @type {Boolean}\n     */\n    this.loading = false;\n\n    /**\n     * The max configured character count the bio may be\n     */\n    this.bioMaxLength = app.forum.attribute('fof-user-bio.maxLength');\n\n    /**\n     * The placeholder shown in the bio textbox when no input is set.\n     */\n    this.bioPlaceholder =\n      app.session && app.session.user && app.session.user.id() === this.attrs.user.id()\n        ? // Normal placeholder if they're looking at their own profile\n          app.translator.trans('fof-user-bio.forum.userbioPlaceholder')\n        : // Special placeholder if someone else is viewing their profile with edit access\n          app.translator.trans('fof-user-bio.forum.userbioPlaceholderOtherUser', {\n            username: this.attrs.user.username(),\n          });\n  }\n\n  view() {\n    const user = this.attrs.user;\n    const editable = this.attrs.user.attribute('canEditBio');\n    let content;\n\n    if (this.editing) {\n      content = (\n        <textarea className=\"FormControl\" placeholder={extractText(this.bioPlaceholder)} rows=\"3\" maxlength={this.bioMaxLength} value={user.bio()} />\n      );\n    } else {\n      let subContent;\n\n      if (this.loading) {\n        subContent = <p className=\"UserBio-placeholder\">{LoadingIndicator.component({ size: 'tiny' })}</p>;\n      } else {\n        const bioHtml = user.bioHtml();\n\n        if (bioHtml) {\n          subContent = m.trust(bioHtml);\n        } else if (editable) {\n          subContent = <p className=\"UserBio-placeholder\">{this.bioPlaceholder}</p>;\n        }\n      }\n\n      content = (\n        <div className=\"UserBio-content\" onclick={editable ? this.edit.bind(this) : () => undefined}>\n          {subContent}\n        </div>\n      );\n    }\n\n    return (\n      <div\n        className={\n          'UserBio ' +\n          classList({\n            editable,\n            editing: this.editing,\n          })\n        }\n      >\n        {content}\n      </div>\n    );\n  }\n\n  /**\n   * Edit the bio.\n   */\n  edit() {\n    this.editing = true;\n    m.redraw.sync();\n\n    const bio = this;\n    const save = function (e) {\n      if (e.shiftKey) return;\n      e.preventDefault();\n      bio.save($(this).val());\n    };\n\n    this.$('textarea').focus().bind('blur', save).bind('keydown', 'return', save);\n    m.redraw();\n  }\n\n  /**\n   * Save the bio.\n   *\n   * @param {String} value\n   */\n  save(value) {\n    const user = this.attrs.user;\n\n    if (user.bio() !== value) {\n      this.loading = true;\n\n      user\n        .save({ bio: value })\n        .catch(() => {})\n        .then(() => {\n          this.loading = false;\n          m.redraw();\n        });\n    }\n\n    this.editing = false;\n    m.redraw();\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import UserBio from './UserBio';\n\nexport const components = {\n  UserBio,\n};\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport 'autolink-js';\nimport computed from 'flarum/common/utils/computed';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport User from 'flarum/common/models/User';\nimport Model from 'flarum/common/Model';\nimport UserBio from './components/UserBio';\n\nexport * from './components';\n\napp.initializers.add('fof-user-bio', () => {\n  User.prototype.bio = Model.attribute('bio');\n  User.prototype.bioHtml = computed('bio', (bio) =>\n    bio ? '<p>' + $('<div/>').text(bio).html().replace(/\\n/g, '<br>').autoLink({ rel: 'nofollow ugc' }) + '</p>' : ''\n  );\n\n  extend(UserCard.prototype, 'infoItems', function (items) {\n    let user = this.attrs.user;\n\n    if (!user.attribute('canViewBio')) {\n      return;\n    }\n\n    items.add('bio', <UserBio user={user} />, -100);\n  });\n});\n"],"names":["h","slice","String","prototype","autoLink","b","f","d","a","e","g","arguments","length","call","c","push","join","this","replace","callback","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","n","getter","__esModule","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","hasOwnProperty","r","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","__proto__","UserBio","subClass","superClass","create","constructor","oninit","vnode","editing","loading","bioMaxLength","app","bioPlaceholder","attrs","user","id","username","view","content","editable","attribute","className","placeholder","extractText","rows","maxlength","bio","subContent","LoadingIndicator","size","bioHtml","m","trust","onclick","edit","bind","classList","redraw","sync","save","shiftKey","preventDefault","$","val","focus","then","Component","components","User","Model","computed","text","html","rel","extend","UserCard","items","add"],"sourceRoot":""}