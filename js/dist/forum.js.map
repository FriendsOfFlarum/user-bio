{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/user-bio/./node_modules/autolink-js/autolink-min.js","webpack://@fof/user-bio/./src/forum/components/UserBio.js","webpack://@fof/user-bio/./src/forum/components/index.js","webpack://@fof/user-bio/./src/forum/index.js","webpack://@fof/user-bio/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/models/User']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/user-bio/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@fof/user-bio/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/user-bio/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/user-bio/webpack/bootstrap","webpack://@fof/user-bio/webpack/runtime/compat get default export","webpack://@fof/user-bio/webpack/runtime/define property getters","webpack://@fof/user-bio/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/user-bio/webpack/runtime/make namespace object"],"sourcesContent":["(function(){var h=[].slice;String.prototype.autoLink=function(){var b,f,d,a,e,g;a=1<=arguments.length?h.call(arguments,0):[];e=/(^|[\\s\\n]|<[A-Za-z]*\\/?>)((?:https?|ftp):\\/\\/[\\-A-Z0-9+\\u0026\\u2019@#\\/%?=()~_|!:,.;]*[\\-A-Z0-9+\\u0026@#\\/%=~()_|])/gi;if(!(0<a.length))return this.replace(e,\"$1<a href='$2'>$2</a>\");d=a[0];f=function(){var c;c=[];for(b in d)g=d[b],\"callback\"!==b&&c.push(\" \"+b+\"='\"+g+\"'\");return c}().join(\"\");return this.replace(e,function(c,b,a){c=(\"function\"===typeof d.callback?d.callback(a):\nvoid 0)||\"<a href='\"+a+\"'\"+f+\">\"+a+\"</a>\";return\"\"+b+c})}}).call(this);\n","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Button from 'flarum/common/components/Button';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\n\n/**\n * The `UserBio` component displays a user's bio, optionally letting the user\n * edit it.\n */\nexport default class UserBio extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    /**\n     * Whether the bio is currently being edited.\n     *\n     * @type {boolean}\n     */\n    this.editing = false;\n\n    /**\n     * Whether the bio is currently being saved.\n     *\n     * @type {boolean}\n     */\n    this.loading = false;\n\n    /**\n     * The rows to show in the textarea by default when editing.\n     * This is set to 5 by default, but can be overridden by the `--bio-max-lines` CSS variable.\n     *\n     * @type {string}\n     */\n    this.textareaRows = '5';\n\n    /**\n     * The max configured character count the bio may be\n     */\n    this.bioMaxLength = app.forum.attribute('fof-user-bio.maxLength');\n\n    /**\n     * The placeholder shown in the bio textbox when no input is set.\n     */\n    this.bioPlaceholder =\n      app.session && app.session.user && app.session.user.id() === this.attrs.user.id()\n        ? // Normal placeholder if they're looking at their own profile\n          app.translator.trans('fof-user-bio.forum.userbioPlaceholder')\n        : // Special placeholder if someone else is viewing their profile with edit access\n          app.translator.trans('fof-user-bio.forum.userbioPlaceholderOtherUser', {\n            username: this.attrs.user.displayName(),\n          });\n  }\n\n  view() {\n    const user = this.attrs.user;\n    const editable = this.attrs.editable && this.attrs.user.attribute('canEditBio');\n    let content;\n\n    if (this.editing) {\n      const tempBio = this.tempBio;\n      const value = tempBio ?? user.bio();\n\n      const focusIfErrored = (vnode) => {\n        const textarea = vnode.dom;\n\n        textarea.value = value;\n\n        if (tempBio !== undefined) {\n          textarea.value = tempBio;\n          textarea.focus();\n\n          if (this.tempSelector !== undefined) {\n            textarea.selectionStart = this.tempSelector;\n            textarea.selectionEnd = this.tempSelector;\n\n            delete this.tempSelector;\n          }\n        }\n      };\n\n      content = (\n        <textarea\n          className=\"FormControl\"\n          placeholder={extractText(this.bioPlaceholder)}\n          rows={this.textareaRows}\n          maxlength={this.bioMaxLength}\n          oncreate={focusIfErrored}\n        />\n      );\n    } else {\n      let subContent;\n\n      if (this.loading) {\n        subContent = (\n          <p className=\"UserBio-placeholder\">\n            <LoadingIndicator />\n          </p>\n        );\n      } else {\n        const bioHtml = user.bioHtml();\n\n        if (bioHtml) {\n          subContent = m.trust(bioHtml);\n        } else if (user.bio()) {\n          subContent = m.trust('<p>' + $('<div/>').text(user.bio()).html().replace(/\\n/g, '<br>').autoLink({ rel: 'nofollow ugc' }) + '</p>');\n        } else if (editable) {\n          subContent = <p className=\"UserBio-placeholder\">{this.bioPlaceholder}</p>;\n        }\n      }\n\n      const maxLines = app.forum.attribute('fof-user-bio.maxLines') || 5;\n\n      content = (\n        <div\n          className=\"UserBio-content\"\n          // onclick={editable ? this.edit.bind(this) : () => undefined}\n          onclick={editable ? this.edit.bind(this) : () => undefined}\n          onkeydown={editable ? this.onkeydown.bind(this) : () => undefined}\n          style={{ '--bio-max-lines': maxLines }}\n          role={editable ? 'button' : undefined}\n          tabindex={editable ? '0' : undefined}\n          aria-label={editable ? app.translator.trans('fof-user-bio.forum.profile.edit_bio_label') : undefined}\n        >\n          {subContent}\n        </div>\n      );\n    }\n\n    return (\n      <div\n        className={\n          'UserBio ' +\n          classList({\n            editable,\n            editing: this.editing,\n          })\n        }\n      >\n        {content}\n        {this.editing && (\n          <div className=\"UserBio-actions\">\n            <Button className=\"Button Button--primary\" onclick={this.save.bind(this)}>\n              {app.translator.trans('fof-user-bio.forum.profile.save_button')}\n            </Button>\n            <Button className=\"Button\" onclick={this.reset.bind(this)}>\n              {app.translator.trans('fof-user-bio.forum.profile.cancel_button')}\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  onkeydown(e) {\n    // Allow keyboard navigation to turn editing mode on\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault();\n      this.edit(e);\n    }\n  }\n\n  /**\n   * Edit the bio.\n   * @param {MouseEvent} e\n   */\n  edit(e) {\n    // Maintain the scroll position & cursor position when editing\n    const selection = window.getSelection();\n    const lineIndex = selection.anchorOffset;\n    let lengthBefore = 0;\n\n    for (let prev = selection.anchorNode.previousSibling; prev; prev = prev.previousSibling) {\n      lengthBefore += prev.textContent.length;\n    }\n\n    const currentScroll = e.target.scrollTop;\n    const index = lengthBefore + lineIndex;\n\n    // Show the same number of lines to avoid layout shift\n    this.textareaRows = getComputedStyle(e.target).getPropertyValue('--bio-max-lines') || '5';\n\n    this.editing = true;\n    m.redraw.sync();\n\n    this.$('textarea').trigger('focus').prop('selectionStart', index).prop('selectionEnd', index).prop('scrollTop', currentScroll);\n  }\n\n  /**\n   * Save the bio.\n   */\n  save() {\n    const value = this.$('textarea').val();\n    const user = this.attrs.user;\n    const tempSelector = this.$('textarea').prop('selectionStart');\n\n    // Don't constantly try to save when blurring textarea\n    if (this.isDirty()) {\n      this.loading = true;\n\n      user\n        .save({ bio: value })\n        .catch(() => {\n          this.tempBio = value;\n          this.tempSelector = tempSelector;\n          this.edit();\n        })\n        .then(() => {\n          this.loading = false;\n          delete this.tempBio;\n          m.redraw();\n        });\n    }\n\n    this.editing = false;\n    m.redraw();\n  }\n\n  reset() {\n    // Either nothing changed or we want to confirm the loss of changes\n    if (!this.isDirty() || confirm(extractText(app.translator.trans('fof-user-bio.forum.profile.cancel_confirm')))) {\n      this.editing = false;\n      delete this.tempBio;\n      m.redraw();\n    }\n  }\n\n  isDirty() {\n    const value = this.$('textarea').val();\n    const user = this.attrs.user;\n\n    return user.bio() !== value;\n  }\n}\n","import UserBio from './UserBio';\n\nexport const components = {\n  UserBio,\n};\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport 'autolink-js';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport User from 'flarum/common/models/User';\nimport Model from 'flarum/common/Model';\nimport UserBio from './components/UserBio';\n\nexport * from './components';\n\napp.initializers.add('fof-user-bio', () => {\n  User.prototype.bio = Model.attribute('bio');\n  User.prototype.bioHtml = Model.attribute('bioHtml');\n\n  extend(UserCard.prototype, 'infoItems', function (items) {\n    let user = this.attrs.user;\n\n    if (!user.attribute('canViewBio')) {\n      return;\n    }\n\n    items.add('bio', <UserBio user={user} editable={this.attrs.editable} />, -100);\n  });\n});\n","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/models/User'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/UserCard'];","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"names":["h","slice","String","prototype","autoLink","b","f","d","a","e","g","arguments","length","call","replace","c","push","join","callback","app","Component","LoadingIndicator","Button","classList","extractText","UserBio","_Component","_inheritsLoose","apply","_proto","oninit","vnode","editing","loading","textareaRows","bioMaxLength","forum","attribute","bioPlaceholder","session","user","id","attrs","translator","trans","username","displayName","view","_this","editable","content","tempBio","value","bio","focusIfErrored","textarea","dom","undefined","focus","tempSelector","selectionStart","selectionEnd","m","className","placeholder","rows","maxlength","oncreate","subContent","bioHtml","trust","$","text","html","rel","maxLines","onclick","edit","bind","onkeydown","style","role","tabindex","save","reset","key","preventDefault","selection","window","getSelection","lineIndex","anchorOffset","lengthBefore","prev","anchorNode","previousSibling","textContent","currentScroll","target","scrollTop","index","getComputedStyle","getPropertyValue","redraw","sync","trigger","prop","_this2","val","isDirty","then","confirm","default","components","extend","UserCard","User","Model","initializers","add","items","setPrototypeOf","subClass","superClass","Object","create","constructor","_setPrototypeOf","o","p","__proto__"],"sourceRoot":""}